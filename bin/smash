#!/usr/bin/env coffee
argv      = require('minimist')(process.argv.slice 2)
chalk     = require 'chalk'

smasher   = require '../src/config/global'
smasher.commander
  .option '-a, --auto',     'auto-accept defaults where possible'
  .option '-w, --watch',    'monitor files for changes and reload browser(s)'
  .option '-s, --serve',    'compile assets and launch a static server'
  .option '-v, --verbose',  'display detailed logs and notifications'
  .option '-m, --mute',     'hide all logs and notifications'
  .option '-c, --cat',      '\'cat\' results of file injection to console'


# Load modules to register commands and tasks

smasher.loadModule m for m in [
  'generate'
  'compile'
  'build'
  'deploy'
  'test'
  'serve'
  'clean'
  'init'
  'apps'
  'document'
  'help'
  'help'
  'help'
  'help'
  'help'
  'help'
]

# Lookup the module needed for this command and init(smasher)
smasher.initCmd argv._[0]

# Parse the arguments for Commander.js
smasher.commander.parse process.argv
