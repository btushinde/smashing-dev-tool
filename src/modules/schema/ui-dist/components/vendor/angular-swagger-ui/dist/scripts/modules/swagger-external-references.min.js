/*
 * Orange angular-swagger-ui - v0.2.3
 *
 * (C) 2015 Orange, all right reserved
 * MIT Licensed
 */
"use strict";angular.module("swaggerUi").service("swaggerUiExternalReferences",["$http","$q","swaggerModules",function(a,b,c){function d(a){k.reject(a)}function e(b,e,f){var g={method:"GET",url:b,transformResponse:function(a){f&&(a=a.replace(/"\$ref": ?"#\/(.*)"/g,'"$ref": "#/definitions/'+f+'#/$1"'));var b;try{b=angular.fromJson(a)}catch(c){d({code:500,message:"failed to parse JSON"})}return b}};c.execute(c.BEFORE_LOAD,g).then(function(){a(g).success(e).error(function(a,b){d({message:a,code:b})})})["catch"](d)}function f(a){var b=a.split("#/"),c=b[0];if(0!==c.indexOf("http")&&0!==c.indexOf("https"))if(0===c.indexOf("/")){var d=URL.parse(j);c=d.protocol+"//"+d.host+c}else{var e=j.lastIndexOf("/");c=j.substring(0,e)+"/"+c}return c}function g(){function a(a){b++,e(f(a.$ref),function(c){b--,delete a.$ref;for(var d in c)a[d]=c[d];0===b&&i()})}var b=0;for(var c in l.paths){var c=l.paths[c];h(c)&&a(c)}0===b&&i()}function h(a){return a&&a.$ref&&0!==a.$ref.indexOf("#/")}function i(){function a(a){var b=a.$ref.split("#/"),c=f(a.$ref);a.$ref="#/definitions/"+a.$ref,g[c]||(d++,g[c]=!0,e(c,function(a){for(var c in a)l.definitions[b[0]+"#/"+c]=a[c];d--,0===d&&k.resolve(!0)},b[0]))}function b(b){h(b)?a(b):h(b.items)&&a(b.items)}function c(a){for(var c=0,d=a.parameters||[],e=d.length;e>c;c++)d[c].schema&&b(d[c].schema);for(var f in a.responses||{})a.responses[f].schema&&b(a.responses[f].schema)}var d=0,g={};for(var i in l.paths){var j=l.paths[i];for(var m in j)c(j[m])}0===d&&k.resolve(!0)}var j,k,l;this.execute=function(a,c){return j=a,l=c,k=b.defer(),g(),k.promise}}]);